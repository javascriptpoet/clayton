<!--
    this:
        rels:[objects]
            array of relationships to display for this field. generated by contextadjust
        value<[Object]> value of the field in collection. passed by af-forms
            a hash by rel names of objects containing a list of selected items for each col.
            for each key/col name:
            items<[object]> structure will vary depending on type of item
                for a collection doc:
                _id<string> id of selected record
                userId<string> id of user that made the reference
                time<date> time reference was made

        attr<Object> attributes passed thru template arguments
    data  pass
        rels<[string]> array of relationship names registered before

-->
<template name="afInputRelations">

    <!-- this is a hidden input element where autoforms will place field value -->
    <select type="hidden" value={{getValue}} {{atts}} multiple></select>
    <div class='container' {{getAttr}}>
        <div class="row">
            <div id="top-row" class='col-md-12'>
                <div class='btn-group' >
                    <button type='button' class='btn btn-primary'>
                        {{#if otherSide.icon}}<span>{{otherSide.icon}}</span>{{/if}}
                        {{otherSide.label}}
                    </button>
                    <button type="button" id="sel-sel" class='btn btn-primary clickable' data-toggle='collapse' data-target='#sel-items'>
                        <span class='badge'>{{getSelItemCount}}</span>
                    </button>
                    <button type="button" id="avail-sel" class='btn btn-primary clickable' data-toggle='collapse' data-target='#avail-items'>
                        <i id="chev-sel" class="fa fa-plus-square-o"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h2 class="panel-title">{{otherSide.label}}: selected items</h2>
                        <div class='pull-right'>
                            <span class='badge'>{{getSelItemCount}}</span>
                            <span class="clickable" data-toggle='collapse' data-target="#sel-items">
                                <i id='chev-sel' class="chev-toggle glyphicon glyphicon-chevron-down"></i>
                            </span >
                        </div>
                    </div>
                    <div id='sel-items' class="panel-body collapse">
                        {{> reactiveTable
                            collection=(getCursor type='selItems')
                            id='sel-items-table'
                            settings=otherSide.tableSettings
                        }}
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h2 class="panel-title">{{otherSide.label}}: available items</h2>
                        <div class='pull-right'>
                            <span class='badge'>{{getAvailItemCount}}</span>
                            <span class="clickable" data-toggle='collapse' data-target="#avail-items">
                                <i id="chev-avail"  class="chev-toggle glyphicon glyphicon-chevron-down"></i>
                            </span>
                        </div>
                    </div>
                    <div id='avail-items' class="panel-body collapse">
                        {{> reactiveTable
                            collection=(getCursor type='availItems')
                            id='avail-items-table'
                            settings=otherSide.tableSettings
                        }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>